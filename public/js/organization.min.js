(function(a){function e(){b.error&&console.log("organization "+b.pos+", "+b.id+", "+b.error);a.getJSON(jsonURL(),{service:"party",pos:b.pos,id:b.id},function(c){c.message?b.error&&console.log(c.message):(a("#cbt_name").val(c.name),a("#cbt_emailaddress").val(c.emailaddress),a("#cbt_dayphone").val(c.dayphone),a("#cbt_webaddress").val(c.webaddress),a("#cbt_commission").val(c.commission),a("#cbt_discount").val(c.discount),a("#cbt_notes").val(c.notes),a("#cbt_terms").val(c.terms))}).error(function(){b.error&&
console.log("party error")});a("#cbt_form").validate({debug:!1,invalidHandler:function(c,b){b.numberOfInvalids()?(a("div.error span").html("Please enter the highlighted field(s)"),a("div.error").show()):a("div.error").hide()},ignore:".ignore",rules:{cbt_name:{required:!0,minlength:5},cbt_emailaddress:{required:!0,email:!0},cbt_dayphone:{required:!0},cbt_webaddress:{required:!0,minlength:3},cbt_commission:{required:!0,number:!0,min:0,max:100},cbt_discount:{required:!0,number:!0,min:0,max:100},cbt_notes:{required:!0,
minlength:10},cbt_terms:{required:!0,minlength:10}},messages:{cbt_name:{required:"Enter the organization holder",minlength:"Minimum {0} characters"},cbt_emailaddress:{required:"Enter the primary email address",email:"Enter a valid address"},cbt_dayphone:{required:"Enter the phone number",phone:"Enter a valid phone number"},cbt_webaddress:{required:"Enter the webaddress URL",minlength:"Minimum {0} characters"},cbt_commission:{required:"Enter manager's commission percentage",number:"Must be a number",
min:"Minimum of {0}",max:"Maximum of {0}"},cbt_discount:{required:"Enter agent's commission percentage",number:"Must be a number",min:"Minimum of {0}",max:"Maximum of {0}"},cbt_notes:{required:"Enter the company description",minlength:"Minimum {0} characters"},cbt_terms:{required:"Enter the terms & conditions",minlength:"Minimum {0} characters"}},submitHandler:function(){b.error&&console.log("organization submitted "+jsonURL()+", "+b.pos+", "+a("#cbt_emailaddress").val()+", "+a("#cbt_name").val()+
", "+a("#cbt_dayphone").val()+", "+a("#cbt_commission").val()+", "+a("#cbt_discount").val()+", "+a("#cbt_notes").val()+", "+a("#cbt_terms").val());a.getJSON(jsonURL(),{service:"party",method:"set",pos:b.pos,id:b.id,date:a.datepicker.formatDate("yy-mm-01",new Date),name:a("#cbt_name").val(),emailaddress:a("#cbt_emailaddress").val(),dayphone:a("#cbt_dayphone").val(),webaddress:a("#cbt_webaddress").val(),commission:a("#cbt_commission").val(),discount:a("#cbt_discount").val(),notes:a("#cbt_notes").val(),
terms:a("#cbt_terms").val()},function(c){c.message?console.log(c.message):a("#cbt_popup").dialog("open")}).error(function(){b.error&&console.log("organization error")})},success:function(){}})}var b={pos:"",id:"",error:!0},d={init:function(c){b=a.extend(b,c);localize(function(){e()})},id:function(a){b.error&&console.log("set id "+a);b.id=a;e()}};a.fn.organization=function(a){if(d[a])return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return d.init.apply(this,
arguments);console.log("Method "+a+" does not exist.")}})(jQuery);

