/* Copyright CBT Limited London - may only used with http://razor-cloud.com services */
(function(c){var a={pos:"",productid:"",currency:"USD",dateformat:"d",numberformat:"c",is_available:"Available",not_available:"Not Available",changeMonth:!0,changeYear:!0,error:!1},d={init:function(b){function d(a){return c.datepicker.formatDate("yy-mm-dd",a)}function h(b,e){a.error&&console.log("quote "+a.pos+", "+a.productid+", "+a.dateformat+", "+a.numberformat+", "+a.is_available+", "+a.not_available+", "+a.error+", "+b+", "+e);b&&e&&c.getJSON(jsonURL(),{service:"quote",pos:a.pos,productid:a.productid,
currency:a.currency,fromdate:b,todate:e},function(b){b.message?a.error&&console.log(b.message):(c("#cbt_price").empty(),c("#cbt_price").append(formatted(b.price,a.numberformat,culture(b.currency))),c("#cbt_quote").empty(),c("#cbt_quote").append(formatted(b.quote,a.numberformat,culture(b.currency))),c("#cbt_deposit").empty(),c("#cbt_deposit").append(b.deposit.toFixed(0)+"%"),c("#cbt_status").empty(),b.available?c("#cbt_status").append(a.is_available):c("#cbt_status").append(a.not_available))}).error(function(){a.error&&
console.log("quote error")})}a=c.extend(a,b);return this.each(function(){localize(function(){var b=c("#cbt_fromdate, #cbt_todate").datepicker({changeMonth:a.changeMonth,changeYear:a.changeYear,numberOfMonths:1,dateFormat:dateFormat(a.dateformat),onSelect:function(a){var f="cbt_fromdate"==this.id?"minDate":"maxDate",g=c(this).data("datepicker"),a=c.datepicker.parseDate(g.settings.dateFormat||c.datepicker._defaults.dateFormat,a,g.settings);b.not(this).datepicker("option",f,a);f=d(c("#cbt_fromdate").datepicker("getDate"));
a=d(c("#cbt_todate").datepicker("getDate"));h(f,a)}});c("#cbt_fromdate, #cbt_todate").val(null)})})},productid:function(b){a.error&&console.log("set productid "+b);a.productid=b},currency:function(b){a.error&&console.log("set currency "+b);a.currency=b}};c.fn.quote=function(a){if(d[a])return d[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"===typeof a||!a)return d.init.apply(this,arguments);console.log("Method "+a+" does not exist.")}})(jQuery);
